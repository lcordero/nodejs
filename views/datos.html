<div id="main-container">
    <input class="nombre" placeholder="DatoNombre" />
    <input class="apellido" placeholder="DatoApellido" />
    <input class="pais" placeholder="DatoPais" />
    <table style="width:100%" class="data_table">
        <thead class="header">
            <tr>
              <th>DatoNombre</th>
              <th>DatoApellido</th>
              <th>DatoPais</th>
            </tr>
        </thead>
      <tbody class="table_content">
      </tbody>
    </table>
  </div>
  <script src="/assets/jquery.js"></script>
  <script src="/assets/socket.io.js"></script>
  <script>
  var table_content = $(".table_content")
  var nombre = $(".nombre")
  var apellido = $('.apellido')
  var pais = $('.pais')



  var socket = io.connect(window.location.host);
  socket.on("connect",function(){
      console.log("connect");
  })

  socket.on("new_dato",function(dato){
      if (!dato.nombre || !dato.apellido || !dato.pais) return
      table_content.append(`
    <tr>
    <th>`+ dato.nombre +`</th>
    <th>`+ dato.apellido +`</th>
    <th>`+ dato.pais +`</th>      
    </tr>
      `)
  })

  socket.on("disconnect",function(){
      console.log("Desconectado");
  })

  nombre.focusout(function(){
    let form = {
      "nombre": nombre.val(),
      "apellido": apellido.val(),
      "pais" : pais.val()
    }
      socket.emit("new_dato",form)
    $.ajax({
      url:"http://"+ window.location.host + "/api/datos/"+ form,
      type: "PUT",
      data: nombre
    })
  })
  apellido.focusout(function(){
    let form = {
      "nombre": nombre.val(),
      "apellido": apellido.val(),
      "pais" : pais.val()
    }
      socket.emit("new_dato",form)
    $.ajax({
      url:"http://"+ window.location.host + "/api/datos/"+ form,
      type: "PUT",
      data: apellido
    })       
  })
  pais.focusout(function(){
    let form = {
      "nombre": nombre.val(),
      "apellido": apellido.val(),
      "pais" : pais.val()
    }
      socket.emit("new_dato", form)
    $.ajax({
      url:"http://"+ window.location.host + "/api/datos/"+ datos,
      type: "PUT",
      data: pais })    
  })

  var load_content = function(url){
      $.get(url,function(data){
          table_content.empty() 
        })  
      
  } 
  load_content("http://"+ window.location.host + "/api/datos")
  
  </script>
  